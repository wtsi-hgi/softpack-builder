debug: false

server:
  host: 0.0.0.0
  port: 7080

services:
  core: https://127.0.0.1:7082

logging:
  filename: prefect.log
  formatters:
    prefect:
      class: prefect.logging.formatters.PrefectFormatter
      format: "%(asctime)s.%(msecs)03d | %(levelname)-7s | %(name)s - %(message)s"
      flow_run_fmt: "%(asctime)s.%(msecs)03d | %(levelname)-7s | Flow run %(flow_run_name)r - %(message)s"
      task_run_fmt: "%(asctime)s.%(msecs)03d | %(levelname)-7s | Task run %(task_run_name)r - %(message)s"
      datefmt: "%H:%M:%S"

vault:
  url:
  path:
  token:

environments:
  path: /tmp

spack:
  path: ./spack
  cache: /tmp
  manifest:
    name: spack.yaml
    specs:
      - pattern: "^r(-.+?)*$"
        spack:
          container:
            images:
              final: rocker/rstudio:4.3.1
    spack:
      config:
        url_fetch_method: curl
        connect_timeout: 600
      view: false
      concretizer:
        unify: when_possible
      container:
        images:
          build: spack/ubuntu-focal:v0.20.1
          final: ubuntu:20.04
        strip: true

container:
  module: singularity.Singularity
  cache: /tmp/cache
  singularity:
    command: singularity
    template: container/singularity_{stage}.def
    build:
      bind: /tmp:/opt/spack-cache,$HOME/.gpg:/opt/softpack/gpg
    spec: singularity_{stage}.def
    image: singularity.sif

modules:
  name: modulefile
  templates:
    default: default
    path: ./templates/modules
    specs:
      - name: rstudio
        pattern: "^r(-.+?)*$"

artifacts:
  registries:
    default:
      url: oras://example.com
      username: username
      password: password

packages:
  repo:
    namespace: softpack
  templates:
    path: ./templates/packages
  exclude:
    - r-methods
    - r-stats
    - r-tools
    - r-utils
  rename:
    r-seurat-object: r-seuratobject
